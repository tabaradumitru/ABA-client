<p-card styleClass="p-mb-3">
  <div class="p-grid p-nogutter p-d-flex p-ai-center">
    <div class="p-col-6">
      <app-breadcrumb [items]="items"></app-breadcrumb>
    </div>
  </div>
</p-card>

<p-card>
  <div class="p-grid">
    <div class="p-col-12">
      <p-table
        [value]="requests"
        [tableStyle]="{'table-layout': 'auto'}"
        selectionMode="single"
        [paginator]="requests?.length > 0"
        [rows]="dataResponse.pageSize"
        [totalRecords]="dataResponse.totalCount"
        [rowsPerPageOptions]="[10,15,20]"
        [(first)]="first"
        [lazy]="true"
        [loading]="configurationService.getLoading(loadingConstant)"
        [lazyLoadOnInit]="false"
        (onLazyLoad)="onLazyLoad($event)"
        (onRowSelect)="onRowSelect($event.data)"
      >
        <ng-template pTemplate="header">
          <tr>
            <th>#</th>
            <th pSortableColumn="first-name">
              Prenume
              <p-sortIcon field="first-name"></p-sortIcon>
            </th>
            <th pSortableColumn="last-name">
              Nume
              <p-sortIcon field="last-name"></p-sortIcon>
            </th>
            <th pSortableColumn="idnp">
              IDNP
              <p-sortIcon field="idnp"></p-sortIcon>
            </th>
            <th pSortableColumn="activity-name">
              Activitate
              <p-sortIcon field="activity-name"></p-sortIcon>
            </th>
            <th>Localitate</th>
<!--            <th pSortableColumn="phone">-->
<!--              Telefon-->
<!--              <p-sortIcon field="phone"></p-sortIcon>-->
<!--            </th>-->
            <th pSortableColumn="start-date">
              Dată Început
              <p-sortIcon field="start-date"></p-sortIcon>
            </th>
            <th pSortableColumn="end-date">
              Dată Sfârșit
              <p-sortIcon field="end-date"></p-sortIcon>
            </th>
            <th pSortableColumn="status-name">
              Status
              <p-sortIcon field="status-name"></p-sortIcon>
            </th>
            <th>Acțiuni</th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-row let-rowIndex="rowIndex">
          <tr [pSelectableRow]="row">
            <td>{{rowIndex + 1}}</td>
            <td>{{row.firstName}}</td>
            <td>{{row.lastName}}</td>
            <td>{{row.citizenIdnp}}</td>
            <td>{{getActivityNameById(row.activityId)}}</td>
            <td>
              <div *ngFor="let area of getAreas(row)">
                <span class="blue-text">Zona:</span> {{area.areaName}}
                <div class="p-ml-4" *ngFor="let district of area.districts">
                  <span class="green-text">Oraș: </span> {{district.districtName}}
                  <div class="p-ml-4 localities-list"><span class="orange-text">Localități:</span> {{getLocalitiesAsString(district.localities)}}</div>
                </div>
              </div>
            </td>
<!--            <td>{{row.phone}}</td>-->
            <td>{{row.startDate | date: 'dd/MM/yyyy'}}</td>
            <td>{{row.endDate | date: 'dd/MM/yyyy'}}</td>
            <td style="min-width: 135px">
              <p-badge [value]="getStatusNameById(row.statusId)" [severity]="getStatusSeverityString(row.statusId)"></p-badge>
            </td>
            <td>
              <button
                type="button"
                pButton
                pRipple
                class="p-button-rounded p-button-secondary p-button-sm"
                icon="pi pi-cog"
                (click)="actions.toggle($event)"
              ></button>

              <p-menu
                #actions
                [popup]="true"
                appendTo="body"
                [model]="actionMenu"
              ></p-menu>
<!--              <button-->
<!--                type="button"-->
<!--                pButton-->
<!--                pRipple-->
<!--                class="p-button-rounded p-button-info p-button-sm p-mr-3"-->
<!--                icon="pi pi-eye"-->
<!--                pTooltip="Vizualizează cererea"-->
<!--                tooltipPosition="top"-->
<!--                *ngIf="row.statusId !== 2"-->
<!--              ></button>-->

<!--              <button-->
<!--                type="button"-->
<!--                pButton-->
<!--                pRipple-->
<!--                class="p-button-rounded p-button-danger p-button-sm"-->
<!--                icon="pi pi-times"-->
<!--                pTooltip="Anulează cererea"-->
<!--                tooltipPosition="top"-->
<!--                *ngIf="row.statusId === 1"-->
<!--              ></button>-->
            </td>
          </tr>
        </ng-template>

      </p-table>
    </div>
  </div>
</p-card>
